#include "tests.h"

u4b_array num1 = {.len = 0, .is_negative = 0, .array = NULL};
u4b_array num2 = {.len = 0, .is_negative = 0, .array = NULL};
u4b_array expected = {.len = 0, .is_negative = 0, .array = NULL};

/**
 * trim_u4b_array - Dummy: trims zeros from end of an array
 * @arr: pointer to a u4b_array struct
 */
void trim_u4b_array(u4b_array *arr)
{
	if (!arr)
		return;

	while (!arr->array[arr->len - 1] && arr->len > 1)
		--arr->len;
}

/**
 * infiX_subtraction - Dummy
 * @n1: unused
 * @n2: unused
 *
 * Return: empty array, NULL on error
 */
u4b_array *infiX_subtraction(u4b_array *n1, u4b_array *n2)
{
	if (!n1 || !n2)
		return (NULL);

	return (alloc_u4b_array(1));
}

/**
 * setup - setups some variables for tests
 */
void setup(void)
{
	return;
}

/**
 * teardown - resets variables for tests.
 */
void teardown(void)
{
	num1.len = 0;
	num1.is_negative = 0;
	num1.array = NULL;

	num2.len = 0;
	num2.is_negative = 0;
	num2.array = NULL;

	expected.len = 0;
	expected.is_negative = 0;
	expected.array = NULL;
}

TestSuite(simple_additions, .init = setup, .fini = teardown);

Test(simple_additions, test_0_plus_0,
	 .description = "0 + 0 = 0", .timeout = 5.0)
{
	uint32_t in1[] = {0}, out[] = {0};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num1);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(simple_additions, test_1_plus_0,
	 .description = "1 + 0 = 1", .timeout = 5.0)
{
	uint32_t in1[] = {1}, in2[] = {0}, out[] = {1};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(simple_additions, test_0_plus_1,
	 .description = "0 + 1 = 1", .timeout = 5.0)
{
	uint32_t in1[] = {0}, in2[] = {1}, out[] = {1};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(simple_additions, test_1_plus_1,
	 .description = "1 + 1 = 2", .timeout = 5.0)
{
	uint32_t in1[] = {1}, out[] = {2};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num1);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(simple_additions, test_999999999_plus_1,
	 .description = "999,999,999 + 1 = 1,000,000,000", .timeout = 5.0)
{
	uint32_t in1[] = {1000000000 - 1}, in2[] = {1}, out[] = {0, 1};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(simple_additions, test_999999999_plus_999999999,
	 .description = "999,999,999 + 999,999,999 = 1,999,999,998",
	 .timeout = 5.0)
{
	uint32_t in1[] = {1000000000 - 1}, in2[] = {1000000000 - 1};
	uint32_t out[] = {999999998, 1};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

TestSuite(negative_additions, .init = setup, .fini = teardown);

Test(negative_additions, test_minus1_plus_minus1,
	 .description = "-1 + -1 = -2", .timeout = 5.0)
{
	uint32_t in1[] = {1}, in2[] = {1};
	uint32_t out[] = {2};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.is_negative = 1;
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.is_negative = 1;
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.is_negative = 1;
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(eq(chr, output->is_negative, expected.is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

TestSuite(large_additions, .init = setup, .fini = teardown);

Test(large_additions, test_largenum1_plus_largenum2,
	 .description = "large1 + large2 = large3", .timeout = 5.0)
{
	uint32_t in1[] = {
		645836236,
		108893430,
		836208119,
		270771001,
		537613755,
		373039867,
		833294108,
		898839418,
		608485063,
		546188873,
		452231917,
		687296422,
		47476452,
		973845669,
		10374451,
		178785181,
		565141096,
		368215581,
		766449833,
		166756900,
		266296935,
		885801432,
		594190765,
		115602107,
		235409739,
		399179115,
		850675236,
		340648369,
		35579268,
		104749163,
		802235901,
		491996281,
		895516593,
		839921180,
		67331942,
		131981816,
		66278514,
		517588243,
		463032241,
		73538353,
		968765061,
		804658266,
		749667814,
		549163798,
		487157519,
		711633003,
		972331418,
		238542068,
		232509426,
		601282914,
		20870386,
		712000569,
		989992175,
		907700216,
		835948618,
		475345425,
		727891135,
		669403730,
		657851929,
		149460078,
		747077950,
		376844618,
		747266956,
		571636193,
		938912751,
		497644611,
		759319233,
		761708391,
		127297673,
		541874763,
		785571425,
		922610518,
		560591749,
		469697144,
		757311785,
		209915325,
		295664549,
		472852029,
		794638917,
		924548269,
		665546560,
		147030781,
		113541635,
		672921659,
		886614454,
		888895933,
		980940268,
		652713160,
		86661318,
		441916746,
		991660090,
		963315434,
		174714048,
		331586295,
		423875918,
		414858407,
		765266782,
		716160639,
		967742753,
		859077762,
		782524464,
		583535642,
		636698233,
		974804082,
		685212215,
		858201489,
		675803213,
		340924961,
		770759371,
		721690082,
		643257228,
		270802820,
		779607128,
		553527402,
		631316996,
		482136841,
		771287864,
		143263302,
		338713965,
		631541059,
		459227990,
		900158607,
		522296074,
		119566232,
		917880407,
		547587665,
		671240039,
		445247134,
		906342086,
		108286736,
		290416205,
		40663846,
		685128427,
		901563774,
		91058525,
		18035945,
		778089791,
		196228057,
		729252095,
		332848879,
		660998583,
		843191333,
		516057405,
		437387938,
		122716597,
		59023219,
		67686962,
		515110063,
		530073379,
		937472478,
		582936187,
		535877748,
		336387069,
		271284634,
		109311068,
		382401380,
		419352682,
		744180245,
		345636197,
		363692395,
		365165427,
		232029093,
		279405477,
		266065847,
		131084246,
		415079114,
		994319536,
		956238199,
		822926172,
		261,
	};
	uint32_t in2[] = {
		641945243,
		201854150,
		945526491,
		588113168,
		422870352,
		400027828,
		354131316,
		480925265,
		366384594,
		756651860,
		371009773,
		458461663,
		551681111,
		462833680,
		349616778,
		736870366,
		341533876,
		212381424,
		817120198,
		279193099,
		387442540,
		745368020,
		17956390,
		352189210,
		827292979,
		546656614,
		694960735,
		161299575,
		126946094,
		768192377,
		94511871,
		671285131,
		387504207,
		453076590,
		823542181,
		979958845,
		756289430,
		489039573,
		222402353,
		740510039,
		876371475,
		704920805,
		347966303,
		963059711,
		630699304,
		860282534,
		861738973,
		953072234,
		757507204,
		543460994,
		55998954,
		123911258,
		815547847,
		9353263,
		532748113,
		557418144,
		657649124,
		33796200,
		101643647,
		664228303,
		450577034,
		994356506,
		652298226,
		917712339,
		662382045,
		774713439,
		608723683,
		53246697,
		677980087,
		46254166,
		612192553,
		864487728,
		132108920,
		599737116,
		862767740,
		684688338,
		79278190,
		652585019,
		309195042,
		757798994,
		842976240,
		592825352,
		536380856,
		355273007,
		511686,
	};
	uint32_t out[] = {
		287781479,
		310747581,
		781734610,
		858884170,
		960484107,
		773067695,
		187425424,
		379764684,
		974869658,
		302840733,
		823241691,
		145758085,
		599157564,
		436679349,
		359991230,
		915655547,
		906674972,
		580597005,
		583570031,
		445950000,
		653739475,
		631169452,
		612147156,
		467791317,
		62702718,
		945835730,
		545635971,
		501947945,
		162525362,
		872941540,
		896747772,
		163281412,
		283020801,
		292997771,
		890874124,
		111940661,
		822567945,
		6627816,
		685434595,
		814048392,
		845136536,
		509579072,
		97634118,
		512223510,
		117856824,
		571915538,
		834070392,
		191614303,
		990016631,
		144743908,
		76869341,
		835911827,
		805540022,
		917053480,
		368696731,
		32763570,
		385540260,
		703199931,
		759495576,
		813688381,
		197654984,
		371201125,
		399565183,
		489348533,
		601294797,
		272358051,
		368042917,
		814955089,
		805277760,
		588128929,
		397763978,
		787098247,
		692700670,
		69434260,
		620079526,
		894603664,
		374942739,
		125437048,
		103833960,
		682347264,
		508522801,
		739856134,
		649922491,
		28194666,
		887126141,
		888895933,
		980940268,
		652713160,
		86661318,
		441916746,
		991660090,
		963315434,
		174714048,
		331586295,
		423875918,
		414858407,
		765266782,
		716160639,
		967742753,
		859077762,
		782524464,
		583535642,
		636698233,
		974804082,
		685212215,
		858201489,
		675803213,
		340924961,
		770759371,
		721690082,
		643257228,
		270802820,
		779607128,
		553527402,
		631316996,
		482136841,
		771287864,
		143263302,
		338713965,
		631541059,
		459227990,
		900158607,
		522296074,
		119566232,
		917880407,
		547587665,
		671240039,
		445247134,
		906342086,
		108286736,
		290416205,
		40663846,
		685128427,
		901563774,
		91058525,
		18035945,
		778089791,
		196228057,
		729252095,
		332848879,
		660998583,
		843191333,
		516057405,
		437387938,
		122716597,
		59023219,
		67686962,
		515110063,
		530073379,
		937472478,
		582936187,
		535877748,
		336387069,
		271284634,
		109311068,
		382401380,
		419352682,
		744180245,
		345636197,
		363692395,
		365165427,
		232029093,
		279405477,
		266065847,
		131084246,
		415079114,
		994319536,
		956238199,
		822926172,
		261,
	};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}

Test(large_additions, test_medium_largenum1_plus_medium_largenum2,
	 .description = "medium_large1 + medium_large2 = medium_large3",
	 .timeout = 5.0)
{
	uint32_t in1[] = {120720357, 397122822, 391212010, 378636564, 527381951, 445364023, 899885040, 831438167, 289912154, 386356373, 467962926, 817125772, 778707749, 515723350, 20924616, 454178424, 114657544, 634432190, 904414952, 143603833, 256133844, 201619676, 377306056, 810451660, 815010674, 281198163, 584823824, 739934236, 774447920, 423387184, 43576798, 141865462, 637259085, 182422433, 869987549, 632282216, 515172654, 118746121, 691817195, 100642458, 401797429, 748808428, 97330459, 859095700, 77613379, 824691165, 375014971, 270261896, 971418347, 287776735, 687392807, 72844992, 808489120, 176184502, 298559149, 515082189, 290641249, 784406918, 18525880, 595556264, 662020707, 137836043, 32027777, 282126204, 398571429, 183240048, 893494027, 908475657, 210325195, 41368093, 567494670, 78549187, 829867982, 939611731, 556446171, 260470617, 388185363, 898568742, 584926832, 930685864, 974259747, 196534676, 548532814, 760521395, 176790149, 995282978, 514569063, 129660418, 873623608, 869739334, 116299016, 931525892, 602082336, 842229732, 82941119, 584280220, 738070679, 549296857, 554682269, 129930289, 352088067, 846285574, 807033108, 924619988, 410518654, 524776378, 210726853, 338324773, 234371231, 345598217, 215913853, 40125185, 169659817, 614457144, 263430597, 839552963, 357693985, 358911228, 31559180, 973973025, 529509086, 130265707, 902771569, 939005219, 909614411, 481137671, 453755527, 315076922, 190488385, 858980849, 914750855, 893492457, 44932638, 537640698, 831905869, 686543771, 164968285, 32694655, 549006585, 907130711, 937753741, 473161761, 60159427, 193787354, 490610706, 977776760, 692607694, 6731141, 102078922, 359416565, 975892579, 663415745, 486552688, 501065002, 401362961, 293547871, 954030315, 717222449, 171804201, 933246578, 628660373, 388008411, 546067821, 318550725, 990682255, 492064339, 647433279, 137385221, 703102597, 102835383, 283915020, 951593059, 607687526, 836935402, 684651719, 23912707, 349733186, 901432221, 855504886, 181532375, 353916766, 945868802, 361242525, 362433248, 541955437, 67937107, 539323500, 323672831, 966437313, 515041060, 651866030, 535923932, 530736394, 457121080, 34778553, 656344571, 766040938, 922800831, 880446217, 23307414, 859193718, 316040919, 995023505, 796297454, 417185715, 452307299, 839507981, 32105848, 520365290, 312607239, 836310795, 763091506, 397308051, 361243336, 973440977, 737772666, 670722593, 362707407, 891880855, 294128542, 811056991, 743094473, 39460017, 899096862, 700449819, 26597046, 259465921, 88171879, 774925466, 948922590, 41763507, 818299518, 949483846, 901683400, 91111044, 894870133, 483119139, 879215171, 907094021, 962766583, 741061235, 120204586, 193580405, 293785014, 701801};
	uint32_t in2[] = {0, 41620510, 66384629, 512842704, 156377468, 105852590, 803594509, 808979101, 622805777, 925209519, 284887972, 99858333, 319133366, 605740584, 738793851, 271659743, 902321912, 768696205, 511006306, 7337951, 747247853, 293618793, 587774858, 638706953, 128463433, 931106827, 240138010, 935268238, 418024541, 563619774, 369239534, 516542736, 202909336, 35747723, 282212072, 201039712, 656439121, 215137863, 21698999, 861890770, 542583594, 113547534, 373072789, 192966940, 7865785, 795014946, 461874707, 695637684, 619374726, 275157163, 461193891, 923349764, 839175931, 767376170, 476312729, 432554187, 506419452, 912018541, 689455264, 525881131, 284228703, 164000278, 653541313, 944809252, 603663845, 737566518, 633710097, 114584616, 805516811, 784628336, 663496167, 767368703, 243415338, 982123814, 998171201, 402791930, 203874425, 907453680, 100179563, 793521892, 148272929, 355466566, 756949607, 941612995, 771269460, 717681923, 310945118, 76712851, 903875042, 814530765, 458235421, 309799588, 737562894, 534890395, 392224023, 757405100, 58763714, 37049208, 113479663, 49630597, 346306993, 738602825, 348617389, 49530722, 947575072, 545434609, 580559989, 471239112, 638155478, 130093532, 445327481, 245574181, 6576491, 470337962, 31016436, 346642283, 64505770, 269943565, 396522982, 459177123, 396623820, 837747134, 976087236, 870532466, 666779800, 530462541, 286121925, 208644877, 161321089, 405997371, 388627677, 906846883, 190792781, 426525850, 943091950, 407577989, 528429762, 725928253, 187476312, 557142554, 261051878, 59174992, 969714456, 731178546, 991532575, 566454920, 285202929, 463891747, 454826979, 554656092, 703078166, 354163514, 292165911, 661445467, 889593388, 94026888, 271316098, 666131865, 191674608, 166009044, 331543499, 471404896, 158629517, 387591833, 485840742, 526678241, 616063976, 774275371, 907776296, 252446485, 353564278, 669823358, 480408263, 521221597, 48968, 0, 999999999, 999999999, 363808569, 552730075, 5116863};
	uint32_t out[] = {120720357, 438743332, 457596639, 891479268, 683759419, 551216613, 703479549, 640417269, 912717932, 311565892, 752850899, 916984105, 97841115, 121463935, 759718468, 725838167, 16979456, 403128396, 415421259, 150941785, 3381697, 495238470, 965080914, 449158613, 943474108, 212304990, 824961835, 675202474, 192472462, 987006959, 412816332, 658408198, 840168421, 218170156, 152199621, 833321929, 171611775, 333883985, 713516194, 962533228, 944381023, 862355962, 470403248, 52062640, 85479165, 619706111, 836889679, 965899580, 590793073, 562933899, 148586698, 996194757, 647665051, 943560673, 774871878, 947636376, 797060701, 696425459, 707981145, 121437395, 946249411, 301836321, 685569090, 226935456, 2235275, 920806567, 527204124, 23060274, 15842007, 825996430, 230990837, 845917891, 73283320, 921735546, 554617373, 663262548, 592059788, 806022422, 685106396, 724207756, 122532677, 552001243, 305482421, 702134391, 948059610, 712964901, 825514182, 206373269, 777498650, 684270100, 574534438, 241325480, 339645231, 377120128, 475165143, 341685320, 796834394, 586346065, 668161932, 179560886, 698395060, 584888399, 155650498, 974150711, 358093726, 70210988, 791286843, 809563885, 872526709, 475691749, 661241334, 285699366, 176236308, 84795106, 294447034, 186195246, 422199756, 628854793, 428082162, 433150148, 926132907, 968012841, 878858805, 809537686, 576394212, 11600213, 739877453, 523721799, 351809474, 264978220, 303378533, 800339341, 235725420, 964166548, 774997819, 94121761, 693398048, 758622908, 736482897, 464273265, 198805620, 532336754, 29873883, 924965901, 482143281, 544231681, 977810624, 470622888, 556905901, 914072657, 678970745, 17579260, 778718600, 162510469, 290956350, 387574760, 225346413, 383354315, 363478810, 99255622, 960203873, 859413307, 704697338, 706142558, 476522997, 18742581, 263497256, 911660593, 610878893, 355281869, 637479298, 621416417, 88095790, 358157000, 684700688, 23912707, 349733185, 901432221, 219313456, 734262451, 359033629, 945868802, 361242525, 362433248, 541955437, 67937107, 539323500, 323672831, 966437313, 515041060, 651866030, 535923932, 530736394, 457121080, 34778553, 656344571, 766040938, 922800831, 880446217, 23307414, 859193718, 316040919, 995023505, 796297454, 417185715, 452307299, 839507981, 32105848, 520365290, 312607239, 836310795, 763091506, 397308051, 361243336, 973440977, 737772666, 670722593, 362707407, 891880855, 294128542, 811056991, 743094473, 39460017, 899096862, 700449819, 26597046, 259465921, 88171879, 774925466, 948922590, 41763507, 818299518, 949483846, 901683400, 91111044, 894870133, 483119139, 879215171, 907094021, 962766583, 741061235, 120204586, 193580405, 293785014, 701801};

	num1.len = sizeof(in1) / sizeof(*in1);
	num1.array = in1;
	num2.len = sizeof(in2) / sizeof(*in2);
	num2.array = in2;
	expected.len = sizeof(out) / sizeof(*out);
	expected.array = out;
	u4b_array *output = infiX_addition(&num1, &num2);

	cr_expect(eq(sz, output->len, expected.len));
	cr_expect(zero(chr, output->is_negative));
	cr_expect(eq(u32[expected.len], output->array, expected.array));
	free_u4b_array(output);
}
